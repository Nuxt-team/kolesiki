{% extends "base.html" %}

{% block title %}–ì–ª–∞–≤–Ω–∞—è - –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω –ö–æ–ª—ë—Å–∏–∫–∏{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="jumbotron bg-light p-5 rounded-lg mb-4">
            <h1 class="display-4">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –º–∞–≥–∞–∑–∏–Ω –ö–æ–ª—ë—Å–∏–∫–∏! üõû</h1>
            <p class="lead">–ó–¥–µ—Å—å –≤—ã –Ω–∞–π–¥–µ—Ç–µ –ª—É—á—à–∏–µ –∫–æ–ª—ë—Å–∞ –∏ –∞–≤—Ç–æ–º–æ–±–∏–ª—å–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –ø–æ –¥–æ—Å—Ç—É–ø–Ω—ã–º —Ü–µ–Ω–∞–º.</p>
            {% if not session.username %}
                <hr class="my-4">
                <p>–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –∏–ª–∏ –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –ø–æ–∫—É–ø–∫–∏!</p>
                <a class="btn btn-primary btn-lg me-2" href="{{ url_for('auth.register_page') }}">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
                <a class="btn btn-outline-primary btn-lg" href="{{ url_for('auth.login_page') }}">–í–æ–π—Ç–∏</a>
            {% endif %}
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-8">
        <h2>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã</h2>
        <div class="row" id="products-list">
            {% if products %}
                {% for product in products %}
                <div class="col-md-4 mb-3">
                    <div class="card product-card">
                        <div class="card-body">
                            <h5 class="card-title">{{ product.name }}</h5>
                            <p class="card-text">{{ product.description[:100] }}{% if product.description|length > 100 %}...{% endif %}</p>
                            <p class="card-text"><strong>{{ "%.2f"|format(product.price) }} —Ä—É–±.</strong></p>
                            <small class="text-muted">–ü—Ä–æ–¥–∞–≤–µ—Ü: {{ product.owner.username }}</small>
                            <div class="btn-group mt-2">
                                {% if session.username and session.username != product.owner.username %}
                                    <form method="POST" action="{{ url_for('products.buy_product', product_id=product.id) }}" class="d-inline" 
                                          onsubmit="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –∫—É–ø–∏—Ç—å —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä?')">
                                        <button type="submit" class="btn btn-primary btn-sm">üí≥ –ö—É–ø–∏—Ç—å</button>
                                    </form>
                                {% endif %}
                                <a href="{{ url_for('products.get_product', product_id=product.id) }}" class="btn btn-outline-primary btn-sm">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <div class="col-12">
                    <div class="alert alert-info">
                        –ü–æ–∫–∞ –Ω–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤. {% if session.username %}<a href="{{ url_for('products.add_product_page') }}">–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—ã–π —Ç–æ–≤–∞—Ä!</a>{% else %}–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–ª—è—Ç—å —Ç–æ–≤–∞—Ä—ã.{% endif %}
                    </div>
                </div>
            {% endif %}
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">
                <h5>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</h5>
            </div>
            <div class="card-body">
                <ul class="list-unstyled">
                    <li><a href="#" class="text-decoration-none">üõû –ö–æ–ª—ë—Å–∞</a></li>
                    <li><a href="#" class="text-decoration-none">üîß –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</a></li>
                    <li><a href="#" class="text-decoration-none">üöó –ê–≤—Ç–æ–∑–∞–ø—á–∞—Å—Ç–∏</a></li>
                    <li><a href="#" class="text-decoration-none">üõ†Ô∏è –ê–∫—Å–µ—Å—Å—É–∞—Ä—ã</a></li>
                </ul>
            </div>
        </div>
        
        {% if session.username %}
        <div class="card mt-3">
            <div class="card-header">
                <h5>–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h5>
            </div>
            <div class="card-body">
                <a href="{{ url_for('users.profile') }}" class="btn btn-outline-dark btn-sm d-block mb-2">üë§ –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</a>
                <a href="{{ url_for('products.add_product_page') }}" class="btn btn-success btn-sm d-block mb-2">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</a>
                <a href="{{ url_for('products.my_products') }}" class="btn btn-info btn-sm d-block mb-2">üì¶ –ú–æ–∏ —Ç–æ–≤–∞—Ä—ã</a>
                <a href="{{ url_for('products.purchased_products') }}" class="btn btn-primary btn-sm d-block mb-2">üõí –ú–æ–∏ –ø–æ–∫—É–ø–∫–∏</a>
                <a href="{{ url_for('users.transfer_page') }}" class="btn btn-warning btn-sm d-block">üí∏ –ü–µ—Ä–µ–≤–µ—Å—Ç–∏ –¥–µ–Ω—å–≥–∏</a>
            </div>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}