{% extends "base.html" %}

{% block title %}–ü–µ—Ä–µ–≤–æ–¥ –¥–µ–Ω–µ–≥ - –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω –ö–æ–ª—ë—Å–∏–∫–∏{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h4>üí∏ –ü–µ—Ä–µ–≤–æ–¥ –¥–µ–Ω–µ–≥</h4>
            </div>
            <div class="card-body">
                {% if current_user %}
                <div class="alert alert-info mb-4">
                    <strong>–í–∞—à —Ç–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å:</strong> {{ "%.2f"|format(current_user.balance) }} —Ä—É–±.
                </div>
                {% endif %}
                
                <form method="POST" onsubmit="return validateTransferForm()">
                    <div class="mb-3">
                        <label for="to_user" class="form-label">üë§ –ü–æ–ª—É—á–∞—Ç–µ–ª—å (–∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)</label>
                        <input type="text" class="form-control" id="to_user" name="to_user" required placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
                        <div class="form-text">–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–≤–µ–¥–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ</div>
                    </div>
                    <div class="mb-3">
                        <label for="amount" class="form-label">üí∞ –°—É–º–º–∞ (—Ä—É–±.)</label>
                        <input type="number" step="0.01" min="0.01" class="form-control" id="amount" name="amount" required placeholder="0.00">
                        <div class="form-text">–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –ø–µ—Ä–µ–≤–æ–¥–∞: 0.01 —Ä—É–±.</div>
                        <div class="invalid-feedback" id="amount-error" style="display: none;">
                            –°—É–º–º–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –±–æ–ª—å—à–µ –Ω—É–ª—è!
                        </div>
                    </div>
                    <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                        <a href="{{ url_for('main.index') }}" class="btn btn-secondary me-md-2">‚ùå –û—Ç–º–µ–Ω–∞</a>
                        <button type="submit" class="btn btn-warning">üí∏ –ü–µ—Ä–µ–≤–µ—Å—Ç–∏ –¥–µ–Ω—å–≥–∏</button>
                    </div>
                </form>
            </div>
        </div>
        
        {% if current_user %}
        <div class="card mt-4">
            <div class="card-header">
                <h6>üìã –ë—ã—Å—Ç—Ä—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã</h6>
            </div>
            <div class="card-body">
                <p class="text-muted mb-3">–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Å—É–º–º—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –≤—ã–±–æ—Ä–∞:</p>
                <div class="btn-group" role="group">
                    <button type="button" class="btn btn-outline-secondary btn-sm" onclick="setAmount(100)">100 —Ä—É–±.</button>
                    <button type="button" class="btn btn-outline-secondary btn-sm" onclick="setAmount(500)">500 —Ä—É–±.</button>
                    <button type="button" class="btn btn-outline-secondary btn-sm" onclick="setAmount(1000)">1,000 —Ä—É–±.</button>
                    <button type="button" class="btn btn-outline-secondary btn-sm" onclick="setAmount(5000)">5,000 —Ä—É–±.</button>
                </div>
            </div>
        </div>
        {% endif %}
    </div>
</div>

<script>
function setAmount(amount) {
    document.getElementById('amount').value = amount;
}

function validateTransferForm() {
    const amountInput = document.getElementById('amount');
    const amountError = document.getElementById('amount-error');
    const amount = parseFloat(amountInput.value);
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Å—É–º–º–∞ –±–æ–ª—å—à–µ –Ω—É–ª—è
    if (amount <= 0) {
        amountInput.classList.add('is-invalid');
        amountError.style.display = 'block';
        return false; // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É —Ñ–æ—Ä–º—ã
    }
    
    // –£–±–∏—Ä–∞–µ–º –æ—à–∏–±–∫—É –µ—Å–ª–∏ –≤—Å–µ –æ–∫
    amountInput.classList.remove('is-invalid');
    amountError.style.display = 'none';
    
    return true; // –†–∞–∑—Ä–µ—à–∞–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É —Ñ–æ—Ä–º—ã
}

// –£–±–∏—Ä–∞–µ–º –æ—à–∏–±–∫—É –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ–ª—è
document.addEventListener('DOMContentLoaded', function() {
    const amountInput = document.getElementById('amount');
    if (amountInput) {
        amountInput.addEventListener('input', function() {
            const amountError = document.getElementById('amount-error');
            if (parseFloat(this.value) > 0) {
                this.classList.remove('is-invalid');
                amountError.style.display = 'none';
            }
        });
    }
});
</script>
{% endblock %}